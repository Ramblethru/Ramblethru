<div class="ramble-title">
	<% if @ramble.destination %>
	<%= current_user.name %>'s trip to: <%= @ramble.destination.split.map(&:capitalize).join(' ') %>
	<% else %>
	<h1>NAME OF YOUR RAMBLE HERE</h1>
	<% end %>

	<% if @ramble.start_date && @ramble.end_date %>
	<div class="start-end">
		From <%= @ramble.start_date %> to <%= @ramble.end_date %>
	</div>
	<% end %>
</div>
<div id='map' class='dark'></div>
<script type='text/javascript'>
  var latitude= '<%=@ramble.latitude%>';
  var longitude= '<%=@ramble.longitude%>';
  var destination='<%=@ramble.destination.split.map(&:capitalize).join(' ')%>';
  var map = L.mapbox.map('map', 'gregurton.kbc7dghp').setView([latitude, longitude], 5).setZoom([14]);
  L.mapbox.markerLayer({
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [longitude, latitude ]
    },
    properties: {
      title: destination,
      description: 'Your destination!',
      'marker-size': 'large',
      'marker-color': '#af703a'
    }
  }).addTo(map);
</script>
<div class="container">
	<div class="ramble-notes">
		<h2 class="notes">NOTES</h2>
		<%= render "notes/note_form" %>
		<% if @ramble.notes != nil %>
			<% @ramble.notes.each do |note| %>
				<div class="notebody">
					<div id="<%= dom_id(note) %>">
						<% if note.body %><span id="note-label">Note: </span><span id="note-body">
							<%= note.body %></span> <p><span id="tag-label">Tag(s): </span><span id="note-tag"><%= note.tag_list %></span></p>
							<% if current_user.rambles.include?(@ramble) %>
								<i class="fa fa-pencil-square-o"></i>
								<%= link_to 'Edit', edit_ramble_note_path(@ramble.id, note.id), :class => "edit-note" %> 
								<i class="fa fa-trash"></i>
								<%= link_to 'Delete', note, method: :delete, remote: true, :class => "delete-note" %>
							<% end %>
						<% end %>
					</div>
				</div>
			<% end %>
			<% else %>
			You haven't created any notes yet!
		
		<% end %>
		<div class="end"></div>
	</div>
	
	<div class="api-feed">
		<div id="feed-title">Recommendations</div>
			<div class="foursq">
			<i class="fa fa-foursquare ramble"></i>
				<div id="four-title">Foursquare:</div>
					<% @foursquare_venue.each do |f| %>
					<li>
						<div id="f-venue-title">
							<%= f["venue"]["name"] %><hr>
						</div>
					</li>
					<span id="f-address">Address: <%= f["venue"]["location"]["address"] %></span>
						 	 <% f["tips"] %>
						 	 <% f["tips"].each do |g| %>
								<article><%= link_to g["text"], g["canonicalUrl"], :class => "four-tip"%></article><hr class="tip">
						 	<% end %>
					<% end %>
			</div>
			<div class="ramble-yelp">
			<i class="fa fa-yelp ramble"></i>
				<div id="yelp-title">Yelp:</div>
					<% @yelp.businesses.each do |y| %>
						<li>
							<%= link_to y.name, y.url, :class => "yelp-venue-title" %>
							<%= link_to image_tag y.rating_img_url_small %><hr>
						</li>
						<article class="yelp-venue-tip"><%= y.snippet_text %></article>
						<hr class="y-tip">
					<% end %>
			</div>
			<div class="ramble-instagram">
			<i class="fa fa-instagram ramble"></i>
				<div id="insta-title">Instagram:</div>
					<div class="i-images">
					<% i = @instagram_images.each do |i| %>
						<%= link_to image_tag i["images"]["thumbnail"]["url"], :class => "instagram-thumb" %>
						<%= button_to 'Save this Image', { :controller => 'rambles', :action => 'add_instagram'}, :class => "insta-save" do %>
							<i class="fa fa-star-o"></i> <span id="save">Save</span>
						<% end %>
						<hr class="i-tip">
					<% end %>
					</div>
			</div>
			<div class="ramble-reddit">
			<i class="fa fa-reddit ramble"></i>
				<div id="red-title">Reddit:</div>
					<% @reddit_thread.each do |r| %>
						<li>
							<article>
								<%= link_to r["data"]["title"], r["data"]["url"], :class => "reddit-thread-title" %>
							</article>
						</li>
					<% end %>
			</div>

<div class="recommended-notes">
	<h4>RELEVANT NOTES GO HERE</h4>
	<% ramble = Ramble.where(:destination => @ramble.destination)  %>
	<% ramble.each do |r| %>
	<% if r.user_id != current_user.id %>
	<% r.notes.each do |n| %>
	<div class="nbody">Note: <%= n.body %></div>
	<div class="ntag">Tag: <%= n.tag_list %></div>
	<% end %>
	<% end %>
	<% end %>
</div>
</div>
</div>
</div>

